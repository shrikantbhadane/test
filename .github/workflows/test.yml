name: CI
on:
 push:
 workflow_dispatch:
jobs:
 compile:
  runs-on: ubuntu-latest
  steps:
  - name: checkout
    uses: actions/checkout@v3
    
 docker-build:
  needs: compile
  runs-on: ubuntu-latest
  #outputs:
   #build-id: ${{ github.run_id }}
  steps:
   - name: Docker Build
     run: |
      echo "Doing docker build ${{ github.ref }}, ${{ github.event_name }}, ${{ github.event.action }}" 
      sleep 5
      docker images
      echo "Docker done GITHUB-RUNID=${{ github.run_id }}"
      echo "build-id=${{ github.run_id }}" >> $GITHUB_OUTPUT
      
 deploy-dev:
  needs: docker-build
  runs-on: ubuntu-latest
  #env:
   #build-and-verify: ${{needs.docker-build.outputs.build-id}}
  steps:
   - name: Deploy to $stage
     run: |
      echo "Deploying to Dev env."
      sleep 5
      echo "Deploying to Dev env. done "
      echo $build-id
      
      
